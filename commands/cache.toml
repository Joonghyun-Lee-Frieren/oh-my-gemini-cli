# /omg:cache â€” ìºì‹œ ì ì¤‘ë¥  ëª¨ë‹ˆí„°ë§
# í”„ë¡¬í”„íŠ¸ ìºì‹œ ì ì¤‘ë¥ ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•˜ê³  ì´ìƒ ì§•í›„ë¥¼ ê°ì§€í•©ë‹ˆë‹¤.

[command]
name = "omg:cache"
description = "í”„ë¡¬í”„íŠ¸ ìºì‹œ ì ì¤‘ë¥ ì„ ëª¨ë‹ˆí„°ë§í•˜ê³  ë¶„ì„í•©ë‹ˆë‹¤"

[command.args]
history = { type = "boolean", default = false, description = "ì‹œê°„ëŒ€ë³„ ìºì‹œ ì ì¤‘ë¥  ì´ë ¥ í‘œì‹œ" }
alert-threshold = { type = "number", default = 90, description = "ê²½ê³  ë°œìƒ ê¸°ì¤€ ì ì¤‘ë¥  (%)" }
lang = { type = "string", default = "ko", description = "ì¶œë ¥ ì–¸ì–´: ko ë˜ëŠ” en" }
format = { type = "string", default = "compact", description = "ì¶œë ¥ í˜•ì‹: compact ë˜ëŠ” detailed" }

[prompt]
text = """
í”„ë¡¬í”„íŠ¸ ìºì‹œì˜ í˜„ì¬ ìƒíƒœë¥¼ ìƒì„¸í•˜ê²Œ ë¶„ì„í•˜ê³  ë³´ê³ í•´ì£¼ì„¸ìš”.
ì¶œë ¥ ì–¸ì–´ëŠ” `{lang}` ê°’ì„ ë”°ë¥´ì„¸ìš”. (`ko`=í•œêµ­ì–´, `en`=English)
ì¶œë ¥ ë°€ë„ëŠ” `{format}` ê°’ì„ ë”°ë¥´ì„¸ìš”. (`compact`=ì§§ê²Œ, `detailed`=ìì„¸íˆ)

## ìºì‹œ ë°ì´í„°

### í˜„ì¬ ìºì‹œ ìƒíƒœ
!{omg status --cache --json}

### ìµœê·¼ ìš”ì²­ ì´ë ¥ (ìºì‹œ ì ì¤‘/ë¯¸ìŠ¤)
!{omg status --cache-history --json}

## ë¶„ì„ í•­ëª©

### 1. ìºì‹œ ì ì¤‘ë¥  í˜„í™©

```
ğŸ“Š Cache Performance
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ì ì¤‘ë¥ :    {hit_rate}% (ëª©í‘œ {target_rate}%)
ì ì¤‘ ìˆ˜:   {hits}
ë¯¸ìŠ¤ ìˆ˜:   {misses}
ëª©í‘œ ëŒ€ë¹„: {ok_or_warning}
```

### 2. ìºì‹œ ë ˆì´ì–´ ë¶„ì„

ìºì‹œ ë ˆì´ì–´ ìƒì„¸ ê°’ì´ ì œê³µë˜ì§€ ì•ŠëŠ” ê²½ìš°, ì•„ë˜ í‘œëŠ” ì±„ìš°ì§€ ë§ê³  "ë ˆì´ì–´ë³„ ìˆ˜ì¹˜ ë¯¸ì œê³µ"ìœ¼ë¡œ ëª…ì‹œí•˜ì„¸ìš”.

| ë ˆì´ì–´ | í† í° ìˆ˜ | ìºì‹œ ìƒíƒœ | ì•ˆì •ì„± |
|--------|---------|----------|--------|
| ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ | {tokens} | {cached/uncached} | {stable/unstable} |
| ë„êµ¬ ì •ì˜ | {tokens} | {cached/uncached} | {stable/unstable} |
| GEMINI.md | {tokens} | {cached/uncached} | {stable/unstable} |
| ì„¸ì…˜ ì»¨í…ìŠ¤íŠ¸ | {tokens} | {cached/uncached} | N/A |

### 3. ìºì‹œ ë¯¸ìŠ¤ ì›ì¸ ë¶„ì„

ìµœê·¼ ìºì‹œ ë¯¸ìŠ¤ê°€ ë°œìƒí•œ ê²½ìš°:
- **ì ‘ë‘ì‚¬ ë³€ê²½**: ì–´ë–¤ ì ‘ë‘ì‚¬ê°€ ë³€ê²½ë˜ì—ˆëŠ”ì§€
- **ë„êµ¬ ì§‘í•© ë³€ê²½**: ë„êµ¬ê°€ ì¶”ê°€/ì œê±°ë˜ì—ˆëŠ”ì§€
- **ì»´íŒ©ì…˜ ë°œìƒ**: ì»¨í…ìŠ¤íŠ¸ ìš”ì•½ìœ¼ë¡œ ìºì‹œê°€ ë¬´íš¨í™”ë˜ì—ˆëŠ”ì§€

### 4. ë¹„ìš© ì˜í–¥

ìºì‹œ ì ì¤‘ë¥ ì— ë”°ë¥¸ ë¹„ìš© ë¶„ì„:
- ìºì‹œ ì ì¤‘ ì‹œ ë¹„ìš©: ê¸°ë³¸ ë¹„ìš©ì˜ ~25%
- í˜„ì¬ ì ì¤‘ë¥ ë¡œ ì¸í•œ ì ˆê°ì•¡: {savings_or_unavailable}
- ì ì¤‘ë¥  1% ê°œì„  ì‹œ ì¶”ê°€ ì ˆê°: {per_percent_or_unavailable}

### 5. ê¶Œì¥ ì¡°ì¹˜

ìºì‹œ ì ì¤‘ë¥ ì´ ëª©í‘œ ë¯¸ë§Œì´ë©´:
- âš ï¸ ì¦‰ì‹œ `$context-optimize`ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”
- ì ‘ë‘ì‚¬ ì•ˆì •ì„±ì„ ì ê²€í•˜ì„¸ìš”
- ë¶ˆí•„ìš”í•œ ë„êµ¬ ë³€ê²½ì„ ë˜ëŒë¦¬ì„¸ìš”

ìºì‹œ ì ì¤‘ë¥ ì´ ëª©í‘œ ì´ìƒì´ë©´:
- âœ… í˜„ì¬ ìƒíƒœë¥¼ ìœ ì§€í•˜ì„¸ìš”
- ë‹¤ìŒ ì ê²€ ì‹œì ì„ ì•Œë ¤ì£¼ì„¸ìš”

ë°˜ë“œì‹œ ì…ë ¥ JSONì˜ ì‹¤ì œ í‚¤ë§Œ ì‚¬ìš©í•˜ì„¸ìš”: `hit_rate`, `target_rate`, `hits`, `misses`.

## ê²½ê³  ë¬¸êµ¬ ë¶„ê¸° ê·œì¹™

- `hit_rate < {alert-threshold}` ì´ë©´:
  - `{lang}=ko`: "âš ï¸ ê²½ê³ : ìºì‹œ ì ì¤‘ë¥ ì´ ì„ê³„ê°’({alert-threshold}%) ë¯¸ë§Œì…ë‹ˆë‹¤. ì¦‰ì‹œ ìµœì í™”ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤."
  - `{lang}=en`: "âš ï¸ Warning: Cache hit rate is below threshold ({alert-threshold}%). Optimization is recommended now."
- `hit_rate >= {alert-threshold}` ì´ë©´:
  - `{lang}=ko`: "âœ… ì •ìƒ: ìºì‹œ ì ì¤‘ë¥ ì´ ì„ê³„ê°’ ì´ìƒì…ë‹ˆë‹¤."
  - `{lang}=en`: "âœ… Healthy: Cache hit rate is above threshold."

## ì¶œë ¥ í…œí”Œë¦¿ (ì–¸ì–´ ì„ íƒí˜•)

{lang}=ko:
```
ğŸ“Š ìºì‹œ ì„±ëŠ¥ ë³´ê³ ì„œ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ì ì¤‘ë¥ : {hit_rate}% (ì„ê³„ê°’: {alert-threshold}%)
ì ì¤‘/ë¯¸ìŠ¤: {hits}/{misses}
íŒì •: {ok_or_warning}
ê¶Œì¥ ì¡°ì¹˜: {actions}
```

{lang}=en:
```
ğŸ“Š Cache Performance Report
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Hit rate: {hit_rate}% (threshold: {alert-threshold}%)
Hits/Misses: {hits}/{misses}
Status: {ok_or_warning}
Recommended actions: {actions}
```
"""
